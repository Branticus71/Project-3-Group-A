---
title: "Project-3-Group-A"
author: "Brant Armstrong, Naman Goel"
date: "2022-11-06"
output: html_document
---
# Necessary Packages
```{r, message = FALSE}
library(tidyverse)
library(caret)
library(corrplot)
library(corrr)
library(psych)
```
# Reading in Data

```{r}
df <- read_csv("./OnlineNewsPopularity.csv")
df
#Subsetting to just lifestyle articles and removing the two non-predictive variables.
df_lifestyle <- df %>%
                filter(data_channel_is_lifestyle == 1) %>%
                select(-c(url, timedelta, data_channel_is_bus, data_channel_is_entertainment,
                          data_channel_is_socmed, data_channel_is_tech, data_channel_is_world,
                          data_channel_is_lifestyle))
df_lifestyle
```
# EDA

Calculating the correlation of each predictor variable with the outcome variable `shares` and graphing it.
```{r}
cor_lifestyle <- df_lifestyle %>%
  correlate() %>%
  focus(shares)
cor_lifestyle

#Graph of the correlations but it's pretty messy. Might be a way to automate only including the top 10 correlated variables to use later
cor_lifestyle %>% 
  mutate(term = factor(term, levels = term[order(shares)])) %>%  # Order by correlation strength
  ggplot(aes(x = term, y = shares)) +
    geom_bar(stat = "identity") +
    ylab("Correlation with shares") +
    xlab("Variable") +
  theme(axis.text.x = element_text(angle = 90)) 
```

Principal Components
```{r}
df_continuous <- df_lifestyle %>%
  select(-c(weekday_is_monday, weekday_is_tuesday,
            weekday_is_wednesday, weekday_is_thursday,
            weekday_is_friday, weekday_is_saturday,
            weekday_is_sunday, is_weekend))
PCs <- prcomp(select(df_continuous, -shares), center = TRUE, scale = TRUE)
par(mfrow = c(1,2))
plot(PCs$sdev^2/sum(PCs$sdev^2), xlab = "Principal Component",
ylab = "Proportion of Variance Explained", ylim = c(0, 1), type = 'b')
plot(cumsum(PCs$sdev^2/sum(PCs$sdev^2)), xlab = "Principal Component",
ylab = "Cum. Prop of Variance Explained", ylim = c(0, 1), type = 'b')
#Need to automate a method to select only PC's I want, either all eigenvalues>1 or until 80% variance explained most likely.
```
Summary statistics using the `describe` function from the `psych` package.
```{r}
describe(df_continuous, fast = TRUE)
```

Summary statistics for each variable categorized by newly created `Day` variable.
```{r}
categ_lifestyle <- df_lifestyle %>%
  mutate(Day = if_else(weekday_is_monday == 1, "Monday", if_else(weekday_is_tuesday == 1, "Tuesday",
               if_else(weekday_is_wednesday == 1, "Wednesday", if_else(weekday_is_thursday == 1,
               "Thursday", if_else(weekday_is_friday == 1, "Friday", if_else(weekday_is_saturday == 1,
               "Saturday", "Sunday")))))))
table_by_day <- describeBy(categ_lifestyle, group = categ_lifestyle$Day, fast = TRUE)
table_by_day
```

